<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Quick start · MLJLinearModels.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">MLJLinearModels.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>Quick start</a><ul class="internal"><li><a class="tocitem" href="#Using-MLJLinearModels-by-itself-1"><span>Using MLJLinearModels by itself</span></a></li><li><a class="tocitem" href="#Using-MLJLinearModels-with-MLJ-1"><span>Using MLJLinearModels with MLJ</span></a></li></ul></li><li><a class="tocitem" href="../models/">Models</a></li><li><a class="tocitem" href="../solvers/">Solvers</a></li><li><a class="tocitem" href="../api/">API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Quick start</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Quick start</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/JuliaAI/MLJLinearModels.jl/blob/master/docs/src/quickstart.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Quick-start-1"><a class="docs-heading-anchor" href="#Quick-start-1">Quick start</a><a class="docs-heading-anchor-permalink" href="#Quick-start-1" title="Permalink"></a></h1><h2 id="Using-MLJLinearModels-by-itself-1"><a class="docs-heading-anchor" href="#Using-MLJLinearModels-by-itself-1">Using MLJLinearModels by itself</a><a class="docs-heading-anchor-permalink" href="#Using-MLJLinearModels-by-itself-1" title="Permalink"></a></h2><p>The package works by</p><ol><li>specifying the kind of model you want along with its hyper-parameters,</li><li>calling <code>fit</code> with that model and the data: <code>fit(model, X, y)</code>.</li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The convention in this  package is that the feature matrix has dimensions <span>$n \times p$</span> where <span>$n$</span> is the number of records (points) and <span>$p$</span> is the number of features (dimensions).</p></div></div><p>Below we show an example of regression and an example of classification.</p><h3 id="Regression-1"><a class="docs-heading-anchor" href="#Regression-1">Regression</a><a class="docs-heading-anchor-permalink" href="#Regression-1" title="Permalink"></a></h3><p>The lasso regression corresponds to a l2-loss function with a l1-penalty:</p><div>\[\theta_{\text{Lasso}} = \frac12\|y-X\theta\|_2^2 + \lambda\|\theta\|_1\]</div><p>which you can create as follows:</p><pre><code class="language-julia">n = 500
p = 5
X = randn(n, p)
y = randn(n)
λ = 0.7
lasso = LassoRegression(λ)
theta = fit(lasso, X, y)</code></pre><p>By default this fits an intercept so that the dimension of <code>theta</code> in the example above is <code>p+1</code>, the <strong>last</strong> element being the intercept.</p><p>So if you wanted to compute the RMSE norm of the residuals you would do</p><pre><code class="language-julia">r = y - hcat(X, ones(n)) * theta
e = sqrt(sum(abs2.(r)) / n)</code></pre><p>You can also just compute the objective:</p><pre><code class="language-julia">o = objective(lasso, X, y) # function of theta
o(theta) # value at the theta obtained from the fit</code></pre><h3 id="Classification-1"><a class="docs-heading-anchor" href="#Classification-1">Classification</a><a class="docs-heading-anchor-permalink" href="#Classification-1" title="Permalink"></a></h3><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>The convention in this  package for <strong>binary</strong> classification is that the entries of <span>$y$</span> are <span>$\{\pm 1\}$</span> while for <strong>multiclass</strong> classification the entries of <span>$y$</span> are <span>$\{1,\dots,c\}$</span> where <code>c</code> is the number of classes. If you use MLJ you won&#39;t have to  think about this.</p></div></div><p>Here&#39;s an example for a logistic classifier (binary classification) with a standard L2 regularisation:</p><pre><code class="language-julia">n = 500
p = 5
X = randn(n, p)
y = 2 * (rand(n) .&lt; 0.5) .- 1   # entries are +-1
λ = 0.5
logistic = LogisticRegression(λ)
theta = fit(logistic, X, y)</code></pre><p>The process for a multiclass classification is identical (you can either call <code>LogisticRegression</code> or <code>MultinomialRegression</code> it will lead to the same model). The  only difference is that the encoding of the target is  expected to  be <code>{1, ..., c}</code> where <code>c</code> is the number of classes.</p><p>Note that for a multiclass classification, <code>theta</code> is a <strong>vector</strong> of dimension <span>$p \times c$</span> or <span>$(p+1)\times c$</span> depending on whether an intercept is fitted or not. To make sense of that vector you can <em>reshape</em> it as follows (assuming no intercept is fitted):</p><pre><code class="language-julia">W = reshape(theta, p, c)</code></pre><p>where <code>W</code> is a matrix with each column corresponding to each of the <code>c</code> classes. If you needed to predict using that matrix you would do <span>$XW$</span> which would give you a matrix of size <span>$n \times p$</span> on which you could apply a softmax for each row to get a score per class for each instance (i.e. a normalised matrix of size <span>$n\times p$</span> where you can interpret the entry <span>$(i,j)$</span> as the score attributed by the model to example <code>i</code> to belong in class <code>j</code>).</p><h2 id="Using-MLJLinearModels-with-MLJ-1"><a class="docs-heading-anchor" href="#Using-MLJLinearModels-with-MLJ-1">Using MLJLinearModels with MLJ</a><a class="docs-heading-anchor-permalink" href="#Using-MLJLinearModels-with-MLJ-1" title="Permalink"></a></h2><p>Using MLJLinearModels in the context of MLJ allows to benefit from tools for encoding data, dealing with missing values, keeping track of class labels, doing hyper-parameter tuning, composing models, etc.</p><p>In order to load a model from MLJLinearModels you need to call <code>@load model_name pkg=MLJLinearModels</code> where <code>model_name</code> follows the MLJ conventions and is one of</p><ul><li>(Regression): <code>LinearRegressor</code>, <code>RidgeRegressor</code>, <code>LassoRegressor</code>, <code>ElasticNetRegressor</code>, <code>RobustRegressor</code>, <code>HuberRegressor</code>, <code>QuantileRegressor</code>, <code>LADRegressor</code></li><li>(Classification): <code>LogisticClassifier</code>, <code>MultinomialClassifier</code></li></ul><p>Note that the names are slightly different (ending in <em>Regressor</em> or <em>Classifier</em>).</p><p>Check out the <a href="https://alan-turing-institute.github.io/MLJ.jl/stable/">MLJ documentation</a> or at the <a href="https://alan-turing-institute.github.io/MLJTutorials/">MLJ Tutorials</a> for more information on MLJ itself.</p><h3 id="Regression-2"><a class="docs-heading-anchor" href="#Regression-2">Regression</a><a class="docs-heading-anchor-permalink" href="#Regression-2" title="Permalink"></a></h3><p>Let&#39;s fit a simple <a href="https://en.wikipedia.org/wiki/Huber_loss">Huber regression</a> on the <a href="https://www.cs.toronto.edu/~delve/data/boston/bostonDetail.html">boston</a> dataset.</p><pre><code class="language-julia">using MLJ
@load HuberRegressor pkg=MLJLinearModels

X, y = @load_boston
mdl = HuberRegressor()
mach = machine(mdl, X, y)
fit!(mach)
params = fitted_params(mach)

params.coefs # coefficient of the regression with names
params.intercept # intercept</code></pre><p>MLJ makes it seamless to do  prediction as well:</p><pre><code class="language-julia">ypred = predict(mach, X)</code></pre><h3 id="Classification-2"><a class="docs-heading-anchor" href="#Classification-2">Classification</a><a class="docs-heading-anchor-permalink" href="#Classification-2" title="Permalink"></a></h3><p>Let&#39;s fit a simple multiclass classifier on the Iris dataset</p><pre><code class="language-julia">using MLJ
@load MultinomialClassifier pkg=MLJLinearModels

X, y = @load_iris
mdl = MultinomialClassifier(lambda=0.5, gamma=0.7)
mach = machine(mdl, X, y)
fit!(mach)
params = fitted_params(mach)

params.coefs # coefficients of the regression
params.intercept # intercepts</code></pre><p><strong>Note</strong>: for a multiclass classification like the one above, each class gets its own model so for instance <code>params.intercept</code> has 3 values, likewise <code>params.coefs.sepal_length</code> has 3 values.</p><p>Predictions are easy too, note that this is a <em>probabilistic model</em>: it returns <strong>scores</strong> per class:</p><pre><code class="language-julia">ypred = predict(mach, X)
ypred[1]</code></pre><p>That first element is a <code>UnivariateFinite</code> distribution object which keeps track of each class labels (<code>setosa</code>, <code>versicolor</code>, <code>virginica</code>) and a score for each class (in my case: <code>0.991</code>, <code>0.009</code> and <code>0</code>).</p><p>You can collapse that to a single prediction if you would like using  <code>predict_mode</code>:</p><pre><code class="language-julia">ypred = predict_mode(mach, rows=1:2)</code></pre><p>Which, in my case, gives <code>setosa</code>, <code>setosa</code> (correct in both cases).</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><a class="docs-footer-nextpage" href="../models/">Models »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Monday 28 February 2022 12:36">Monday 28 February 2022</span>. Using Julia version 1.6.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
